rulesPath: ../tls-rules.yaml
providers:
- name: builtin
  dataPath: ./data/testdata
- name: go
  dataPath: ./data/testdata
tests:
- ruleID: fips-go-tls-00100
  testCases:
  - name: tc-insecure-skip-verify
    hasIncidents:
      atLeast: 1
      messageMatches: "InsecureSkipVerify.*disables certificate validation"

- ruleID: fips-go-tls-00101
  testCases:
  - name: tc-max-version-blocking
    hasIncidents:
      atLeast: 1
      messageMatches: "Blocks PQC|Post-Quantum Cryptography requires TLS 1.3"

- ruleID: fips-go-tls-00102
  testCases:
  - name: tc-hardcoded-ciphersuites
    hasIncidents:
      atLeast: 1
      messageMatches: "Blocks Agility|Hardcoded cipher suites prevent"

- ruleID: fips-go-tls-00103
  testCases:
  - name: tc-cert-validation-override
    hasIncidents:
      atLeast: 1
      messageMatches: "Security Review Required|Custom certificate verification"

- ruleID: fips-go-tls-00104
  testCases:
  - name: tc-grpc-insecure
    hasIncidents:
      atLeast: 1
      messageMatches: "gRPC.*Insecure|insecure.NewCredentials"

- ruleID: fips-go-tls-00106
  testCases:
  - name: tc-plain-http
    hasIncidents:
      atLeast: 1
      messageMatches: "Plain HTTP|service mesh"

- ruleID: fips-go-tls-00107
  testCases:
  - name: tc-database-tls-disabled
    hasIncidents:
      atLeast: 1
      messageMatches: "Database TLS Disabled|sslmode=disable"

- ruleID: fips-go-tls-00108
  testCases:
  - name: tc-empty-servername
    hasIncidents:
      atLeast: 1
      messageMatches: "Hostname Verification Disabled|ServerName.*empty"

- ruleID: fips-go-tls-00200
  testCases:
  - name: tc-manual-tls-config
    hasIncidents:
      atLeast: 1
      messageMatches: "Manual.*tls.Config"

- ruleID: fips-go-tls-00201
  testCases:
  - name: tc-min-version-hardcoded
    hasIncidents:
      atLeast: 1
      messageMatches: "MinVersion|Legacy Lock"

- ruleID: fips-go-tls-00202
  testCases:
  - name: tc-http-client-tls
    hasIncidents:
      atLeast: 1
      messageMatches: "Custom HTTP Client TLS|TLSClientConfig"

- ruleID: fips-go-tls-00203
  testCases:
  - name: tc-http-server-tls
    hasIncidents:
      atLeast: 1
      messageMatches: "Custom HTTP Server TLS"

- ruleID: fips-go-tls-00109
  testCases:
  - name: tc-grpc-custom-tls
    hasIncidents:
      atLeast: 1
      messageMatches: "gRPC Custom TLS Credentials|credentials.NewTLS"

- ruleID: fips-go-tls-00110
  testCases:
  - name: tc-k8s-client-tls-override
    hasIncidents:
      atLeast: 1
      messageMatches: "Kubernetes Client TLS Override|rest.Config"

- ruleID: fips-go-tls-00205
  testCases:
  - name: tc-hardcoded-tls13
    hasIncidents:
      atLeast: 1
      messageMatches: "Hardcoded TLS 1.3|dynamically configured"

- ruleID: fips-go-tls-00105
  testCases:
  - name: tc-k8s-client-insecure
    hasIncidents:
      atLeast: 1
      messageMatches: "Kubernetes Client Insecure|Insecure.*true.*rest.TLSClientConfig"

- ruleID: fips-go-tls-00204
  testCases:
  - name: tc-reflection-insecure-skip-verify
    hasIncidents:
      atLeast: 1
      messageMatches: "Reflection TLS Bypass|FieldByName.*InsecureSkipVerify"

- ruleID: fips-go-tls-00206
  testCases:
  - name: tc-curve-preferences-block-pqc
    hasIncidents:
      atLeast: 1
      messageMatches: "CurvePreferences|post-quantum"

- ruleID: fips-go-tls-00207
  testCases:
  - name: tc-x25519-without-mlkem
    hasIncidents:
      atLeast: 1
      messageMatches: "X25519.*Without PQC|X25519MLKEM768"
