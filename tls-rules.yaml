- ruleID: fips-go-tls-00100
  labels:
    - "konveyor.io/target=go"
  effort: 5
  category: mandatory
  description: "Unacceptable: InsecureSkipVerify disables certificate validation"
  when:
    or:
      - builtin.filecontent:
          pattern: 'InsecureSkipVerify\s*:\s*true'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.InsecureSkipVerify\s*=\s*true'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.Insecure\s*=\s*true'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'TLSClientConfig\.Insecure\s*=\s*true'
          filePattern: "*.go"
  message: |
    Critical Security Vulnerability. InsecureSkipVerify: true disables certificate validation,
    allowing man-in-the-middle attacks.

    Action: Remove immediately. If used for testing, ensure it never reaches production.
    Use build tags or environment checks to prevent this in production builds.
  tag:
    - "FIPS-140=Unacceptable"
    - "TLS=Security-Bypass"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00101
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "Requires Analysis: MaxVersion may block TLS 1.3 and Post-Quantum Cryptography"
  when:
    or:
      - builtin.filecontent:
          pattern: 'MaxVersion\s*:\s*tls\.VersionTLS1[012]'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.MaxVersion\s*=\s*tls\.VersionTLS1[012]'
          filePattern: "*.go"
  message: |
    Blocks PQC. Post-Quantum Cryptography requires TLS 1.3.
    Hardcoding MaxVersion to TLS 1.2 or below prevents the upgrade path.

    Action: Remove MaxVersion or set it dynamically from the API Server profile.
  links:
    - title: "NIST SP 800-52 Rev 2 - TLS Guidelines"
      url: "https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final"
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Blocks-Agility"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00102
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "Requires Analysis: Hardcoded CipherSuites may block algorithm rotation"
  when:
    or:
      - builtin.filecontent:
          pattern: 'CipherSuites\s*:\s*\['
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.CipherSuites\s*=\s*\[\]uint16\s*\{'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.CipherSuites\s*=\s*append\('
          filePattern: "*.go"
  message: |
    Blocks Agility. Hardcoded cipher suites prevent the platform from
    rotating insecure algorithms when vulnerabilities are discovered.

    Action: Remove the CipherSuites field. Inherit ciphers from the API Server profile.
  links:
    - title: "NIST SP 800-52 Rev 2 - TLS Guidelines"
      url: "https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final"
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Blocks-Agility"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00103
  labels:
    - "konveyor.io/target=go"
  effort: 5
  category: potential
  description: "Requires Analysis: Custom certificate verification may weaken trust chain"
  when:
    or:
      - builtin.filecontent:
          pattern: 'VerifyPeerCertificate\s*:\s*func'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'VerifyConnection\s*:\s*func'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.VerifyPeerCertificate\s*=\s*func'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.VerifyConnection\s*=\s*func'
          filePattern: "*.go"
  message: |
    Security Review Required. Custom certificate verification function detected.
    This overrides Go's default trust chain validation.

    Detected patterns:
    - VerifyPeerCertificate: func(...) - custom peer certificate verification
    - VerifyConnection: func(...) - custom connection state verification

    Custom verification functions can introduce security vulnerabilities if they:
    - Always return nil (bypasses all validation)
    - Have incomplete validation logic
    - Skip certain certificate checks

    Action: Review the custom verification function to ensure it properly validates
    certificates. If not needed, remove it to use Go's secure defaults.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Verification-Override"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00104
  labels:
    - "konveyor.io/target=go"
  effort: 4
  category: mandatory
  description: "Unacceptable: gRPC TLS credential override bypasses service mesh security"
  when:
    or:
      - builtin.filecontent:
          pattern: 'grpc\.WithInsecure\s*\(\s*\)'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'grpc\.WithTransportCredentials\s*\(\s*insecure\.NewCredentials\s*\(\s*\)\s*\)'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'insecure\.NewCredentials\s*\(\s*\)'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'grpc\.Creds\s*\(\s*insecure\.NewCredentials'
          filePattern: "*.go"
  message: |
    gRPC Insecure Connection. Using grpc.WithInsecure() or insecure.NewCredentials()
    bypasses TLS entirely, eliminating transport security.

    This defeats:
    - Service mesh mTLS policies
    - Certificate-based authentication
    - Transport encryption

    Action: Use service mesh mTLS or properly configured TLS credentials.
    For development, use environment-based switches that are disabled in production.
  tag:
    - "FIPS-140=Unacceptable"
    - "TLS=gRPC-Insecure"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00109
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "Requires Analysis: gRPC custom TLS credential override may bypass platform profile"
  when:
    or:
      - builtin.filecontent:
          pattern: 'credentials\.NewTLS\s*\('
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'grpc\.WithTransportCredentials\s*\(\s*credentials\.NewTLS'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'grpc\.Creds\s*\(\s*credentials\.NewTLS'
          filePattern: "*.go"
  message: |
    gRPC Custom TLS Credentials. Custom TLS configuration passed to gRPC
    may override the platform TLS profile settings.

    Detected patterns:
    - credentials.NewTLS(&tls.Config{...}) with custom TLS config
    - grpc.WithTransportCredentials with custom credentials

    This may hardcode TLS versions, cipher suites, or curve preferences
    that diverge from the centrally managed TLS profile.

    Action: Ensure the tls.Config passed to credentials.NewTLS is built
    from the API Server TLS profile rather than hardcoded values.
    Use apiserver.ObserveTLSSecurityProfile or fetch the profile dynamically.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=gRPC-TLS-Override"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00105
  labels:
    - "konveyor.io/target=go"
  effort: 4
  category: mandatory
  description: "Unacceptable: Kubernetes client TLS override bypasses cluster security"
  when:
    or:
      - builtin.filecontent:
          pattern: 'TLSClientConfig\s*:\s*rest\.TLSClientConfig\s*\{[^}]*Insecure\s*:\s*true'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLSClientConfig\.Insecure\s*=\s*true'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'rest\.TLSClientConfig\s*\{[^}]*Insecure\s*:\s*true'
          filePattern: "*.go"
  message: |
    Kubernetes Client Insecure. Setting Insecure: true in rest.TLSClientConfig
    bypasses cluster security policies and certificate validation.

    This allows:
    - Unauthorized API server access
    - Man-in-the-middle attacks on cluster communication
    - Bypass of RBAC through certificate impersonation

    Action: Use in-cluster configuration with properly configured service accounts.
    Never set Insecure: true in production Kubernetes clients.
  tag:
    - "FIPS-140=Unacceptable"
    - "TLS=K8s-Client-Insecure"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00110
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "Requires Analysis: Kubernetes client custom TLS override may bypass platform profile"
  when:
    or:
      - builtin.filecontent:
          pattern: 'rest\.Config\s*\{[^}]*TLSClientConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLSClientConfig\s*=\s*rest\.TLSClientConfig\s*\{'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'rest\.TLSClientConfig\s*\{[^}]*CertFile'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'rest\.TLSClientConfig\s*\{[^}]*KeyFile'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'rest\.TLSClientConfig\s*\{[^}]*CAFile'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'rest\.TLSClientConfig\s*\{[^}]*CertData'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'TLSClientConfig\s*:\s*rest\.TLSClientConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'CertFile\s*:'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'KeyFile\s*:'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'CAFile\s*:'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'CertData\s*:'
          filePattern: "*.go"
  message: |
    Kubernetes Client TLS Override. Custom TLS configuration in rest.Config
    may override platform TLS profile settings.

    Detected patterns:
    - rest.Config with custom TLSClientConfig
    - Custom certificate/key file paths
    - Inline certificate data

    Even when not setting Insecure: true, custom TLS configurations can
    hardcode TLS versions, cipher suites, or certificates that diverge
    from the centrally managed TLS profile.

    Action: Review the TLS configuration to ensure it inherits settings
    from the API Server TLS profile. Use in-cluster configuration where
    possible. If custom certs are required, ensure TLS version and cipher
    settings still come from the platform profile.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=K8s-Client-TLS-Override"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00106
  labels:
    - "konveyor.io/target=go"
  effort: 4
  category: potential
  description: "Requires Analysis: Plain HTTP communication detected"
  when:
    or:
      # Detect HTTP URLs with variable hostnames (likely service-to-service)
      - builtin.filecontent:
          pattern: '"http://"\s*\+\s*\w+'
          filePattern: "*.go"
      # Detect HTTP client calls with hardcoded URLs
      - builtin.filecontent:
          pattern: 'http\.Get\s*\(\s*"http://\w'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'http\.Post\s*\(\s*"http://\w'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'http\.NewRequest\s*\([^,]+,\s*"http://\w'
          filePattern: "*.go"
  message: |
    Plain HTTP Communication Detected. Review if this bypasses service mesh security.

    NOTE: This rule may flag localhost connections. Manual review required.

    In a service mesh environment, service-to-service communication should
    go through the mesh to benefit from:
    - Mutual TLS (mTLS) encryption
    - Identity-based access control
    - Traffic observability and tracing

    Acceptable uses of plain HTTP:
    - localhost/127.0.0.1 connections (loopback)
    - Health check endpoints on localhost
    - Sidecar proxy communication (localhost:port)
    - Test code and fixtures

    Action: If this is service-to-service communication over a network,
    use HTTPS or rely on service mesh mTLS. Review and document if plain
    HTTP is intentional for a valid use case.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Plain-HTTP"
    - "CWE=CWE-319"

- ruleID: fips-go-tls-00107
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: mandatory
  description: "Unacceptable: Database connection with TLS/SSL disabled"
  when:
    or:
      - builtin.filecontent:
          pattern: 'sslmode=disable'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'ssl=false'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'tls=false'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.SSLMode\s*=\s*"disable"'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLSConfig\s*=\s*"false"'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.SSL\.Enable\s*=\s*false'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLS\.Enable\s*=\s*false'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.Net\.TLS\.Enable\s*=\s*false'
          filePattern: "*.go"
  message: |
    Database TLS Disabled. Disabling TLS/SSL for database connections exposes
    sensitive data to network interception.

    Detected patterns include:
    - sslmode=disable (PostgreSQL)
    - ssl=false / tls=false (MySQL)
    - SSLMode = "disable"
    - TLS.Enable = false

    Action: Enable TLS for all database connections. Use certificate verification
    with trusted CA certificates. Configure connection strings to require TLS.
  tag:
    - "FIPS-140=Unacceptable"
    - "TLS=Database-Insecure"
    - "CWE=CWE-319"

- ruleID: fips-go-tls-00108
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: mandatory
  description: "Unacceptable: Empty ServerName disables hostname verification"
  when:
    builtin.filecontent:
      pattern: '\.ServerName\s*=\s*""'
      filePattern: "*.go"
  message: |
    Hostname Verification Disabled. Setting ServerName to empty string disables
    TLS hostname verification, allowing certificate substitution attacks.

    The TLS handshake will accept any valid certificate, even if it was issued
    for a different hostname.

    Action: Set ServerName to the expected hostname of the server you are connecting to.
    This ensures the certificate matches the intended destination.
  tag:
    - "FIPS-140=Unacceptable"
    - "TLS=Hostname-Bypass"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00200
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: Manual tls.Config creation detected"
  when:
    or:
      - builtin.filecontent:
          pattern: '&tls\.Config\s*\{'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'new\s*\(\s*tls\.Config\s*\)'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'tls\.Config\s*\{'
          filePattern: "*.go"
  message: |
    Manual TLS Configuration. You are manually creating a tls.Config struct
    instead of loading the cluster default.

    Note: An empty tls.Config{} that relies on Go's secure defaults is acceptable
    and preferred over hardcoding values.

    Action: Check the source of configuration values.
    - If empty config (relying on defaults): acceptable
    - If loading from API Server profile: acceptable
    - If hardcoding values: refactor to use dynamic profile loading
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Manual-Config"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00201
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: MinVersion hardcoded may block future TLS requirements"
  when:
    or:
      - builtin.filecontent:
          pattern: 'MinVersion\s*:\s*tls\.VersionTLS1[012]'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.MinVersion\s*=\s*tls\.VersionTLS1[012]'
          filePattern: "*.go"
  message: |
    Legacy Lock. While TLS 1.2 is currently secure, hardcoding MinVersion
    prevents future enforcement of TLS 1.3-only requirements.

    Action: Better to load this from the API Server profile, but less critical
    than MaxVersion. Evaluate if dynamic configuration is feasible.
  links:
    - title: "NIST SP 800-52 Rev 2 - TLS Guidelines"
      url: "https://csrc.nist.gov/publications/detail/sp/800-52/rev-2/final"
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Version-Lock"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00205
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: Hardcoded TLS 1.3 should be dynamically configured"
  when:
    or:
      - builtin.filecontent:
          pattern: 'MinVersion\s*:\s*tls\.VersionTLS13'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.MinVersion\s*=\s*tls\.VersionTLS13'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'MaxVersion\s*:\s*tls\.VersionTLS13'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.MaxVersion\s*=\s*tls\.VersionTLS13'
          filePattern: "*.go"
  message: |
    Hardcoded TLS 1.3. While TLS 1.3 is currently the preferred version,
    hardcoding it prevents the component from following the centrally
    managed TLS profile.

    Per OpenShift TLS Profile Compliance guidance:
    "Hardcoding values like 'TLS 1.3' is not an acceptable fix. The component
    must remain compliant as the central policy is updated over time without
    requiring a code change."

    Components must dynamically inherit TLS settings from the API Server,
    Kubelet, or Ingress configuration rather than hardcoding any version.

    Action: Remove hardcoded TLS version. Fetch TLS configuration from:
    1. API Server configuration (default for most components)
    2. Kubelet configuration (only if running on kubelet)
    3. Ingress configuration (only if handling ingress traffic)
    Use apiserver.ObserveTLSSecurityProfile or fetch the profile dynamically.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Hardcoded-Version"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00202
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: HTTP client with custom TLS configuration"
  when:
    or:
      - builtin.filecontent:
          pattern: 'http\.Transport\s*\{[^}]*TLSClientConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '&http\.Transport\s*\{[^}]*TLSClientConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLSClientConfig\s*='
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'TLSClientConfig\s*:\s*&tls\.Config'
          filePattern: "*.go"
  message: |
    Custom HTTP Client TLS. HTTP clients with custom TLSClientConfig may override
    platform TLS profile settings.

    Action: Review TLS configuration to ensure it doesn't override platform profiles:
    - Remove MaxVersion restrictions that block TLS 1.3
    - Use platform TLS profiles when available
    - Ensure MinVersion allows TLS 1.3 if required by profile
    - Do not set InsecureSkipVerify: true
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=HTTP-Client-Config"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00203
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: HTTP server with custom TLS configuration"
  when:
    or:
      - builtin.filecontent:
          pattern: 'http\.Server\s*\{[^}]*TLSConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '&http\.Server\s*\{[^}]*TLSConfig'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.TLSConfig\s*=\s*&tls\.Config'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'TLSConfig\s*:\s*\w'
          filePattern: "*.go"
  message: |
    Custom HTTP Server TLS. HTTP servers with custom TLSConfig may override
    platform TLS profile settings.

    Action: Review TLS configuration to ensure it doesn't override platform profiles:
    - Remove MaxVersion restrictions that block TLS 1.3
    - Use platform TLS profiles when available
    - Ensure MinVersion allows TLS 1.3 if required by profile
    - Fetch TLS configuration from API Server, Ingress, or Kubelet configuration
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=HTTP-Server-Config"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00204
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "Requires Analysis: Reflection-based InsecureSkipVerify manipulation"
  when:
    builtin.filecontent:
      pattern: 'FieldByName\s*\(\s*"InsecureSkipVerify"\s*\)'
      filePattern: "*.go"
  message: |
    Reflection TLS Bypass. Using reflection to set InsecureSkipVerify indicates
    an attempt to dynamically disable certificate validation, possibly to bypass
    static analysis detection.

    This is a high-risk pattern that suggests intentional security bypass.

    Action: Remove reflection-based TLS configuration manipulation.
    Use explicit, auditable configuration instead.
  tag:
    - "FIPS-140=Requires-Analysis"
    - "TLS=Reflection-Bypass"
    - "CWE=CWE-295"

- ruleID: fips-go-tls-00206
  labels:
    - "konveyor.io/target=go"
  effort: 3
  category: potential
  description: "PQC Blocking: CurvePreferences may block post-quantum key exchange"
  when:
    or:
      - builtin.filecontent:
          pattern: 'CurvePreferences\s*:\s*\[\]tls\.CurveID\s*\{'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: '\.CurvePreferences\s*=\s*\[\]tls\.CurveID\s*\{'
          filePattern: "*.go"
  message: |
    PQC Blocking Configuration. Explicit CurvePreferences may block post-quantum
    key exchange in TLS connections.

    In Go 1.24+, the default CurvePreferences includes X25519MLKEM768 (hybrid PQC).
    When you explicitly set CurvePreferences, you override this default.

    Problematic pattern:
      tls.Config{
          CurvePreferences: []tls.CurveID{tls.X25519, tls.CurveP256},
      }

    This blocks:
    - X25519MLKEM768 (Go 1.24+ hybrid PQC)
    - Future post-quantum key exchange mechanisms

    Per OpenShift TLS Profile Compliance guidance, CurvePreferences must be
    fetched from the API Server configuration and applied dynamically.

    Action: Either:
    1. Remove CurvePreferences to use secure defaults (recommended)
    2. Include tls.X25519MLKEM768 in the list (Go 1.24+)
    3. Load curve preferences from platform TLS profile configuration
  links:
    - title: "Go crypto/tls Documentation"
      url: "https://pkg.go.dev/crypto/tls"
    - title: "OpenShift API - TLS Curve Preferences"
      url: "https://github.com/openshift/api/pull/2583"
  tag:
    - "PQC=Blocking"
    - "TLS=CurvePreferences"
    - "CWE=CWE-757"

- ruleID: fips-go-tls-00207
  labels:
    - "konveyor.io/target=go"
  effort: 2
  category: potential
  description: "Requires Analysis: X25519 without ML-KEM may indicate missing PQC"
  when:
    or:
      - builtin.filecontent:
          pattern: 'tls\.X25519[,\)\}\s]'
          filePattern: "*.go"
      - builtin.filecontent:
          pattern: 'CurveID.*X25519[,\)\}\s]'
          filePattern: "*.go"
  message: |
    X25519 Key Exchange Without PQC. Detected X25519 usage that may not include
    the hybrid post-quantum variant.

    Go 1.24+ provides:
    - tls.X25519 (classical, quantum-vulnerable)
    - tls.X25519MLKEM768 (hybrid, quantum-resistant)

    If CurvePreferences explicitly lists X25519 without X25519MLKEM768,
    post-quantum protection is not enabled.

    Action: Review TLS configuration:
    - For Go 1.24+: Ensure X25519MLKEM768 is included or use defaults
    - For Go 1.23: X25519Kyber768Draft00 was experimental
    - For older Go: Consider upgrading for PQC support
    - Best: Load curve preferences from the platform TLS profile
  tag:
    - "PQC=Requires-Analysis"
    - "TLS=X25519"
